<!DOCTYPE html>
<html lang="en">
<head>
    <meta name=viewport content="width=device-width,initial-scale=1">
    <meta charset="utf-8">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script src="https://www.geogebra.org/apps/deployggb.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.23/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html, body {
            display: flex;
            flex-flow: column;
            height: 100%;
            width:100%;
        }
        .full_width {
            flex: 1 1 auto;
            display: flex;
        }
        .half_width {
            height:100%;
            width:50%;
        }
        :has(>.loading) {
            display: flex;
            align-content: center;
            justify-content: center;
            align-items: center;
        }
        .flex_down {
            display: flex;
            flex-flow: column;
            width:100%;
        }
        #solution-steps{
            overflow: hidden;
            max-height: 0;
        }
    </style>
    <title>Test1</title>

</head>
<body>
    <div class="full_width">
        <div class="half_width">
            <div class="flex_down">
                <div>Solution:</div>
                <div class="flex_down" id="solution-steps">
                    <div>$x=\frac{1}{2y}$</div>
                    <div>Test2</div>
                    <div>Test3</div>
                </div>
                <div class="join">
                    <buttton onclick="prevGG()" class="btn join-item">PREV</buttton>
                    <buttton onclick="nextGG()" class="btn join-item">NEXT</buttton>
                    <button class="btn btn-square join-item">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="half_width" id="ggb-element"><span class="loading loading-spinner loading-lg"></span></div>


        <script>
            /*function fixGGB() {
                document.getElementsByClassName("ggbTransform")[0].style.transform='';
                document.getElementById("ggb-element").style.width="";
                document.getElementById("ggb-element").style.height="";
                GGapp.setWidth(document.getElementById("ggb-element").offsetWidth);
                GGapp.setHeight(document.getElementById("ggb-element").offsetHeight);
            }
            window.addEventListener("resize", fixGGB);*/
            GGapp = undefined;
            cc = 0;
            initialCommand = "A=(0,0)\nB=(1,1)\nc=Circle(A,B)\nl=Line(A,B)";
            objList = [["A","B"], ["c"], ["l"]];
            animSpeed = 50; // px/s
            function getStepsHeights() {
                heights = [0];
                steps = document.getElementById("solution-steps").children
                for (var i = 0; i < steps.length; i++) heights.push(steps[i].offsetHeight + heights[i]);
                return heights;
            }
            function nextGG() {
                if (!GGapp || objList.length <= cc) return;
                for (obj of objList[cc]) GGapp.setVisible(obj, true);
                ss = document.getElementById("solution-steps");
                h = ss.offsetHeight;
                h2 = getStepsHeights()[cc+1]
                ss.style.transition = "max-height "+Math.abs(h2-h)/animSpeed+"s ease";
                ss.offsetHeight;
                ss.style.maxHeight = h2 + "px";
                cc += 1;
            }
            function prevGG() {
                if (!GGapp || cc <= 0) return;
                cc -= 1;
                for (obj of objList[cc]) GGapp.setVisible(obj, false);
                ss = document.getElementById("solution-steps");
                h = ss.offsetHeight;
                h2 = getStepsHeights()[cc]
                ss.style.transition = "max-height "+Math.abs(h2-h)/animSpeed+"s ease";
                ss.offsetHeight;
                ss.style.maxHeight = h2 + "px";
            }
            function appletOnLoad(app) {
                GGapp = app;
                app.evalCommand("SetPerspective(\"G\")");
                app.evalCommand(initialCommand);
                for (objs of objList) for (obj of objs) app.setVisible(obj, false);
            }
            var params = {
                    "appName": "geometry",
                    //"width": 600,//document.getElementById("ggb-element").offsetWidth,
                    "allowUpscale": true,
                    "autoHeight": true,
                    "showToolBar": false,
                    "showAlgebraInput": false,
                    "enableLabelDrags":false,
                    "showToolBarHelp":false,
                    "useBrowserForJS":false,
                    "showMenuBar": false,
                    //"showResetIcon": true, //registerClearListener(String JSFunctionName)
                    "appletOnLoad": appletOnLoad
                    };
            var ggbApplet = new GGBApplet(params, true);
            window.addEventListener("load", function() {
                ggbApplet.inject('ggb-element');
            });
        </script>
    </div>
</body>
</html>
