<!DOCTYPE html>
<html lang="en">
<head>
    <meta name=viewport content="width=device-width,initial-scale=1">
    <meta charset="utf-8">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script src="https://www.geogebra.org/apps/deployggb.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.23/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            display: flex;
            flex-flow: column;
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;
        }
        .full_width {
            flex: 1 1 auto;
            display: flex;
            min-width: 0;
            min-height: 0;
        }
        .half_width {
            flex: 0 0 50%;
        }
        @media (max-width: 100vh) {
            .full_width {
                flex-flow: column;
            }
            .explanation {
                order: 2;
            }
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .flex_down {
            display: flex;
            flex-flow: column;
        }
        .explanation {
            flex: 1 1 auto;
            overflow-y: auto;
            min-width: 0;
            min-height: 0;
        }
        #solution-steps{
            overflow: hidden;
            max-height: 0;
        }
    </style>
    <title>Test1</title>

</head>
<body>
    <div class="full_width">
        <div class="half_width explanation">
            <div class="flex_down">
                <div>Solution:</div>
                <div class="flex_down" id="solution-steps">
                    <div>$x=\frac{1}{2y}$</div>
                    <div>Test2<br><br><br><br><br></div>
                    <div>Test3</div>
                </div>
                <div class="join">
                    <buttton onclick="prevGG()" class="btn join-item">PREV</buttton>
                    <buttton onclick="nextGG()" class="btn join-item" id="nextbtn"><div style="position: relative;"><div style="visibility: hidden;">NEXT</div><span class="loading loading-spinner loading-xs"></div></buttton>
                    <button class="btn btn-square join-item">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="half_width" id="ggb-wrapper"><div id="ggb-element"></div></div>


        <script>
            function fixGGB() {
                document.getElementById("ggb-wrapper").style.overflow="hidden";
                //document.getElementsByClassName("ggbTransform")[0].style.transform='';
                GGapp.setWidth(document.getElementById("ggb-wrapper").offsetWidth);
                GGapp.setHeight(document.getElementById("ggb-wrapper").offsetHeight);
            }
            window.addEventListener("resize", ()=>window.setTimeout(fixGGB,0));
            GGapp = undefined;
            cc = 0;
            initialCommand = "A=(0,0)\nB=(1,1)\nc=Circle(A,B)\nl=Line(A,B)";
            objList = [["A","B"], ["c"], ["l"]];
            animSpeed = 200; // px/s
            function getStepsHeights() {
                heights = [0];
                steps = document.getElementById("solution-steps").children
                for (var i = 0; i < steps.length; i++) heights.push(steps[i].offsetHeight + heights[i]);
                return heights;
            }
            function nextGG() {
                if (!GGapp || objList.length <= cc) return;
                for (obj of objList[cc]) GGapp.setVisible(obj, true);
                ss = document.getElementById("solution-steps");
                h = ss.offsetHeight;
                h2 = getStepsHeights()[cc+1]
                ss.style.transition = "max-height "+Math.min(Math.abs(h2-h)/animSpeed, 1)+"s ease";
                ss.offsetHeight;
                ss.style.maxHeight = h2 + "px";
                cc += 1;
            }
            function prevGG() {
                if (!GGapp || cc <= 0) return;
                cc -= 1;
                for (obj of objList[cc]) GGapp.setVisible(obj, false);
                ss = document.getElementById("solution-steps");
                h = ss.offsetHeight;
                h2 = getStepsHeights()[cc]
                ss.style.transition = "max-height "+Math.min(Math.abs(h2-h)/animSpeed, 1)+"s ease";
                ss.offsetHeight;
                ss.style.maxHeight = h2 + "px";
            }
            function appletOnLoad(app) {
                GGapp = app;
                app.evalCommand("SetPerspective(\"G\")");
                app.evalCommand(initialCommand);
                for (objs of objList) for (obj of objs) app.setVisible(obj, false);
                document.getElementById("nextbtn").innerHTML = "NEXT";
            }
            var params = {
                    "appName": "geometry",
                    "width": document.getElementById("ggb-wrapper").offsetWidth,
                    "height": document.getElementById("ggb-wrapper").offsetHeight,
                    "showToolBar": false,
                    "showAlgebraInput": false,
                    "enableLabelDrags":false,
                    "showToolBarHelp":false,
                    "useBrowserForJS":false,
                    "showMenuBar": false,
                    //"showResetIcon": true, //registerClearListener(String JSFunctionName)
                    "appletOnLoad": appletOnLoad
                    };
            var ggbApplet = new GGBApplet(params, true);
            window.addEventListener("load", function() {
                ggbApplet.inject('ggb-element');
            });
        </script>
    </div>
</body>
</html>
